Block I Apollo Guidance Computer (AGC4) assembler version 1.6

First pass: generate symbol table.
Second pass: generate object code.

                          ;------------------------------------------------------------------------- 
                          ; TECO2_DV (file:teco2_DV.asm)
                          ; PURPOSE: Test and checkout program for the Block 1 Apollo Guidance Computer.
                          ; Tests extracode instructions: DV
                          ; 
                          ; OPERATION: Enters an infinite loop at the end of the test. The A register contains 
                          ; the code for the test that failed, or the PASS code if all tests 
                          ; succeeded. See test codes below.
                          ;------------------------------------------------------------------------- 
                          START          EQU      %00            
                          DVtst          EQU      %02            ; DV check failed
                          OVFCNTR        EQU      %00034         ;  overflow counter
                          PASS           EQU      %12345         ; PASSED all checks
                          
                          ; ----------------------------------------------
                          ; ERASEABLE MEMORY -- DATA SEGMENT
                          ; ----------------------------------------------
                                         ORG      %100           ; start of data area
00100    0100     00000 1 curtest        DS       START          ; current test
00101    0101     00000 1 savQ           DS       %0             
00102    0102     00000 1 DVsavA         DS       %0             ; DV test
00103    0103     00000 1 DVindex        DS       %0             
00104    0104     00000 1 DVXTND         DS       %0             ; indexed extend
                          
                          ; ----------------------------------------------
                          ; ENTRY POINTS
                          ; ----------------------------------------------
                                         ORG      GOPROG         
                          goMAIN         EQU      *              
02000    2000 2  0,0000 0                INHINT                  ; disable interrupts
02001    2001 0  1,2010 1                TCR      begin          
02002    2002 0  1,2021 0                TCR      chkDV          ; Test extracode instructions.
02003    2003 0  1,2014 0                TCR      finish         ; Passed all tests.
                          fail           EQU      *              
02004    2004 3  0,0100 0                XCH      curtest        ; load last passed test into A
02005    2005 5  0,0100 0                TS       curtest        
                          end            EQU      *              
02006    2006 0  1,2006 0                TC       end            ; finished, TC trap
                          
                          ; ----------------------------------------------
                          ; INITIALIZE FOR START OF TESTING
                          ; ----------------------------------------------
02007    2007     00000 1 STRTcode       DS       START          
                          begin          EQU      *              
02010    2010 3  1,2007 1                XCH      STRTcode       
02011    2011 5  0,0100 0                TS       curtest        ; set current test code to START
02012    2012 0  0,0000 0                RETURN                  
                          
                          ; ----------------------------------------------
                          ; PASSED ALL TESTS!
                          ; ----------------------------------------------
02013    2013     12345 0 PASScode       DS       PASS           
                          finish         EQU      *              
02014    2014 3  1,2013 1                CAF      PASScode       
02015    2015 5  0,0100 0                TS       curtest        ; set current test code to PASS
02016    2016 0  0,0000 0                RETURN                  
                          
                          ; ----------------------------------------------
                          ; TEST DV INSTRUCTION SUBROUTINE
                          ; L:	DV	K
                          ; Verifies the following:
                          ; - Set C(A) = b(A) / C(K)
                          ; - Set C(Q) = - abs(remainder)
                          ; - Set C(LP) > 0 if quotient is positive
                          ; - Set C(LP) < 0 if quotient is negative
                          ; - Take next instruction from L+1
                          ; ----------------------------------------------
02017    2017     00002 0 DVcode         DS       DVtst          ; code for this test
                          ;DVstart	DS	31	; loop DVstart+1 times
02020    2020     00001 0 DVstart        DS       1              ; loop DVstart+1 times
                          
                          
                          ; ----------------------------------------------
                          ; Check Divide instruction test
                          ; ----------------------------------------------
                          chkDV          EQU      *              
02021    2021 3  0,0001 0                XCH      Q              
02022    2022 5  0,0101 1                TS       savQ           ; save return address
                          
02023    2023 3  1,2017 0                CAF      DVcode         
02024    2024 5  0,0100 0                TS       curtest        ; set code identifying current test
                          
                          ;------------------------------ 
                          ; Decrementing loop
                          ;	- always executes at least once (tests at end of loop)		
                          ;	- loops 'DVstart+1' times; decrements DVindex
                          ;------------------------------ 
02025    2025 3  1,2020 1                XCH      DVstart        ; initialize loop counter
                          
                          ;------------------------------ 
                          ; DV check starts here
                          ; uses DVindex to access test values
                          ;------------------------------ 
                          DVloop         EQU      *              
02026    2026 5  0,0103 0                TS       DVindex        ; save new index
                          
02027    2027 3  2,5777 0                CAF      EXTENDER       
02030    2030 6  0,0103 0                AD       DVindex        
02031    2031 5  0,0104 1                TS       DVXTND         
                          
02032    2032 2  0,0103 1                INDEX    DVindex        
02033    2033 3  1,2071 0                CAF      div1           
02034    2034 2  0,0104 0                INDEX    DVXTND         ; EXTEND using DVindex
02035    2035 5  1,2131 0                DV       div2           
02036    2036 5  0,0102 1                TS       DVsavA         
                          
                          ; verify C(Q)
02037    2037 4  0,0001 1                CS       Q              ; get -A
02040    2040 2  0,0103 1                INDEX    DVindex        
02041    2041 6  1,2231 0                AD       DVchkQ         ; put (-A) + expected value in A
02042    2042 1  0,0000 0                CCS      A              ; compare
02043    2043 0  1,2004 1                TC       fail           ; >0 (A < expected value)
02044    2044 0  1,2004 1                TC       fail           ; +0
02045    2045 0  1,2004 1                TC       fail           ; <0 (A > expected value)
                          
                          ; verify C(A)
02046    2046 4  0,0102 0                CS       DVsavA         ; get -A
02047    2047 2  0,0103 1                INDEX    DVindex        
02050    2050 6  1,2171 1                AD       DVchkA         ; put (-A) + expected value in A
02051    2051 1  0,0000 0                CCS      A              ; compare
02052    2052 0  1,2004 1                TC       fail           ; >0 (A < expected value)
02053    2053 0  1,2004 1                TC       fail           ; +0
02054    2054 0  1,2004 1                TC       fail           ; <0 (A > expected value)
                          
                          ; verify C(LP)
02055    2055 4  0,0003 0                CS       LP             ; get -A
02056    2056 2  0,0103 1                INDEX    DVindex        
02057    2057 6  1,2271 1                AD       DVchkLP        ; put (-A) + expected value in A
02060    2060 1  0,0000 0                CCS      A              ; compare
02061    2061 0  1,2004 1                TC       fail           ; >0 (A < expected value)
02062    2062 0  1,2004 1                TC       fail           ; +0
02063    2063 0  1,2004 1                TC       fail           ; <0 (A > expected value)
                          
                          ;------------------------------ 
                          ; end of DV check
                          ;------------------------------ 
                          
02064    2064 1  0,0103 1                CCS      DVindex        ; done?
02065    2065 0  1,2026 1                TC       DVloop         ; not yet, do next check
                          
02066    2066 3  0,0101 1                XCH      savQ           
02067    2067 5  0,0001 0                TS       Q              ; restore return address
02070    2070 0  0,0000 0                RETURN                  
                          
                          
                          ; ----------------------------------------------
                          ; C(A) test values
                          ; ----------------------------------------------
                          div1           EQU      *              
02071    2071     00000 1                DS       %00000         ; check #00 (+0/+0)
02072    2072     00000 1                DS       %00000         ; check #01 (+0/-0)
02073    2073     77777 0                DS       %77777         ; check #02 (-0/+0)
02074    2074     77777 0                DS       %77777         ; check #03 (-0/-0)
                          
02075    2075     00000 1                DS       %00000         ; check #04 (+0/+1)
02076    2076     00000 1                DS       %00000         ; check #05 (+0/-1)
02077    2077     77777 0                DS       %77777         ; check #06 (-0/+1)
02100    2100     77777 0                DS       %77777         ; check #07 (-0/-1)
                          
02101    2101     00000 1                DS       %00000         ; check #08 (+0/+16383)
02102    2102     00000 1                DS       %00000         ; check #09 (+0/-16383)
02103    2103     77777 0                DS       %77777         ; check #10 (-0/+16383)
02104    2104     77777 0                DS       %77777         ; check #11 (-0/-16383)
                          
02105    2105     37776 0                DS       %37776         ; check #12 (+16382/+16383)
02106    2106     37776 0                DS       %37776         ; check #13 (+16382/-16383)
02107    2107     40001 1                DS       %40001         ; check #14 (-16382/+16383)
02110    2110     40001 1                DS       %40001         ; check #15 (-16382/-16383)
                          
02111    2111     37777 1                DS       %37777         ; check #16 (+16383/+16383)
02112    2112     37777 1                DS       %37777         ; check #17 (+16383/-16383)
02113    2113     40000 0                DS       %40000         ; check #18 (-16383/+16383)
02114    2114     40000 0                DS       %40000         ; check #19 (-16383/-16383)
                          
02115    2115     00001 0                DS       %00001         ; check #20 (+1/+2)
02116    2116     00001 0                DS       %00001         ; check #21 (+1/+3)
02117    2117     00001 0                DS       %00001         ; check #22 (+1/+4)
02120    2120     00001 0                DS       %00001         ; check #23 (+1/+5)
02121    2121     00001 0                DS       %00001         ; check #24 (+1/+6)
02122    2122     00001 0                DS       %00001         ; check #25 (+1/+7)
02123    2123     00001 0                DS       %00001         ; check #26 (+1/+8)
                          
02124    2124     00001 0                DS       %00001         ; check #27 (+1/+6)
02125    2125     00002 0                DS       %00002         ; check #28 (+2/+12)
02126    2126     00004 0                DS       %00004         ; check #29 (+4/+24)
02127    2127     00010 0                DS       %00010         ; check #30 (+8/+48)
02130    2130     00020 0                DS       %00020         ; check #31 (+16/+96)
                          
                          ; ----------------------------------------------
                          ; C(K) test values
                          ; ----------------------------------------------
                          div2           EQU      *              
02131    2131     00000 1                DS       %00000         ; check #00 (+0/+0)
02132    2132     77777 0                DS       %77777         ; check #01 (+0/-0)
02133    2133     00000 1                DS       %00000         ; check #02 (-0/+0)
02134    2134     77777 0                DS       %77777         ; check #03 (-0/-0)
                          
02135    2135     00001 0                DS       %00001         ; check #04 (+0/+1)
02136    2136     77776 1                DS       %77776         ; check #05 (+0/-1)
02137    2137     00001 0                DS       %00001         ; check #06 (-0/+1)
02140    2140     77776 1                DS       %77776         ; check #07 (-0/-1)
                          
02141    2141     37777 1                DS       %37777         ; check #08 (+0/+16383)
02142    2142     40000 0                DS       %40000         ; check #09 (+0/-16383)
02143    2143     37777 1                DS       %37777         ; check #10 (-0/+16383)
02144    2144     40000 0                DS       %40000         ; check #11 (-0/-16383)
                          
02145    2145     37777 1                DS       %37777         ; check #12 (+16382/+16383)
02146    2146     40000 0                DS       %40000         ; check #13 (+16382/-16383)
02147    2147     37777 1                DS       %37777         ; check #14 (-16382/+16383)
02150    2150     40000 0                DS       %40000         ; check #15 (-16382/-16383)
                          
02151    2151     37777 1                DS       %37777         ; check #16 (+16383/+16383)
02152    2152     40000 0                DS       %40000         ; check #17 (+16383/-16383)
02153    2153     37777 1                DS       %37777         ; check #18 (-16383/+16383)
02154    2154     40000 0                DS       %40000         ; check #19 (-16383/-16383)
                          
02155    2155     00002 0                DS       %00002         ; check #20 (+1/+2)
02156    2156     00003 1                DS       %00003         ; check #21 (+1/+3)
02157    2157     00004 0                DS       %00004         ; check #22 (+1/+4)
02160    2160     00005 1                DS       %00005         ; check #23 (+1/+5)
02161    2161     00006 1                DS       %00006         ; check #24 (+1/+6)
02162    2162     00007 0                DS       %00007         ; check #25 (+1/+7)
02163    2163     00010 0                DS       %00010         ; check #26 (+1/+8)
                          
02164    2164     00006 1                DS       %00006         ; check #27 (+1/+6)
02165    2165     00014 1                DS       %00014         ; check #28 (+2/+12)
02166    2166     00030 1                DS       %00030         ; check #29 (+4/+24)
02167    2167     00060 1                DS       %00060         ; check #30 (+8/+48)
02170    2170     00140 1                DS       %00140         ; check #31 (+16/+96)
                          
                          ; ----------------------------------------------
                          ; A = quotient
                          ; ----------------------------------------------
                          DVchkA         EQU      *              
02171    2171     37777 1                DS       %37777         ; check #00 (+0/+0)
02172    2172     40000 0                DS       %40000         ; check #01 (+0/-0)
02173    2173     40000 0                DS       %40000         ; check #02 (-0/+0)
02174    2174     37777 1                DS       %37777         ; check #03 (-0/-0)
                          
02175    2175     00000 1                DS       %00000         ; check #04 (+0/+1)
02176    2176     77777 0                DS       %77777         ; check #05 (+0/-1)
02177    2177     77777 0                DS       %77777         ; check #06 (-0/+1)
02200    2200     00000 1                DS       %00000         ; check #07 (-0/-1)
                          
02201    2201     00000 1                DS       %00000         ; check #08 (+0/+16383)
02202    2202     77777 0                DS       %77777         ; check #09 (+0/-16383)
02203    2203     77777 0                DS       %77777         ; check #10 (-0/+16383)
02204    2204     00000 1                DS       %00000         ; check #11 (-0/-16383)
                          
02205    2205     37776 0                DS       %37776         ; check #12 (+16382/+16383)
02206    2206     40001 1                DS       %40001         ; check #13 (+16382/-16383)
02207    2207     40001 1                DS       %40001         ; check #14 (-16382/+16383)
02210    2210     37776 0                DS       %37776         ; check #15 (-16382/-16383)
                          
02211    2211     37777 1                DS       %37777         ; check #16 (+16383/+16383)
02212    2212     40000 0                DS       %40000         ; check #17 (+16383/-16383)
02213    2213     40000 0                DS       %40000         ; check #18 (-16383/+16383)
02214    2214     37777 1                DS       %37777         ; check #19 (-16383/-16383)
                          
02215    2215     20000 0                DS       %20000         ; check #20 (+1/+2)
02216    2216     12525 0                DS       %12525         ; check #21 (+1/+3)
02217    2217     10000 0                DS       %10000         ; check #22 (+1/+4)
02220    2220     06314 1                DS       %06314         ; check #23 (+1/+5)
02221    2221     05252 1                DS       %05252         ; check #24 (+1/+6)
02222    2222     04444 1                DS       %04444         ; check #25 (+1/+7)
02223    2223     04000 0                DS       %04000         ; check #26 (+1/+8)
                          
02224    2224     05252 1                DS       %05252         ; check #27 (+1/+6)
02225    2225     05252 1                DS       %05252         ; check #28 (+2/+12)
02226    2226     05252 1                DS       %05252         ; check #29 (+4/+24)
02227    2227     05252 1                DS       %05252         ; check #30 (+8/+48)
02230    2230     05252 1                DS       %05252         ; check #31 (+16/+96)
                          
                          ; ----------------------------------------------
                          ; Q = remainder
                          ; ----------------------------------------------
                          DVchkQ         EQU      *              
02231    2231     77777 0                DS       %77777         ; check #00 (+0/+0)
02232    2232     77777 0                DS       %77777         ; check #01 (+0/-0)
02233    2233     77777 0                DS       %77777         ; check #02 (-0/+0)
02234    2234     77777 0                DS       %77777         ; check #03 (-0/-0)
                          
02235    2235     77777 0                DS       %77777         ; check #04 (+0/+1)
02236    2236     77777 0                DS       %77777         ; check #05 (+0/-1)
02237    2237     77777 0                DS       %77777         ; check #06 (-0/+1)
02240    2240     77777 0                DS       %77777         ; check #07 (-0/-1)
                          
02241    2241     77777 0                DS       %77777         ; check #08 (+0/+16383)
02242    2242     77777 0                DS       %77777         ; check #09 (+0/-16383)
02243    2243     77777 0                DS       %77777         ; check #10 (-0/+16383)
02244    2244     77777 0                DS       %77777         ; check #11 (-0/-16383)
                          
02245    2245     40001 1                DS       %40001         ; check #12 (+16382/+16383)
02246    2246     40001 1                DS       %40001         ; check #13 (+16382/-16383)
02247    2247     40001 1                DS       %40001         ; check #14 (-16382/+16383)
02250    2250     40001 1                DS       %40001         ; check #15 (-16382/-16383)
                          
02251    2251     40000 0                DS       %40000         ; check #16 (+16383/+16383)
02252    2252     40000 0                DS       %40000         ; check #17 (+16383/-16383)
02253    2253     40000 0                DS       %40000         ; check #18 (-16383/+16383)
02254    2254     40000 0                DS       %40000         ; check #19 (-16383/-16383)
                          
02255    2255     77777 0                DS       %77777         ; check #20 (+1/+2)
02256    2256     77776 1                DS       %77776         ; check #21 (+1/+3)
02257    2257     77777 0                DS       %77777         ; check #22 (+1/+4)
02260    2260     77773 1                DS       %77773         ; check #23 (+1/+5)
02261    2261     77773 1                DS       %77773         ; check #24 (+1/+6)
02262    2262     77773 1                DS       %77773         ; check #25 (+1/+7)
02263    2263     77777 0                DS       %77777         ; check #26 (+1/+8)
                          
02264    2264     77773 1                DS       %77773         ; check #27 (+1/+6)
02265    2265     77767 1                DS       %77767         ; check #28 (+2/+12)
02266    2266     77757 1                DS       %77757         ; check #29 (+4/+24)
02267    2267     77737 1                DS       %77737         ; check #30 (+8/+48)
02270    2270     77677 1                DS       %77677         ; check #31 (+16/+96)
                          
                          ; ----------------------------------------------
                          ; LP = sign
                          ; ----------------------------------------------
                          DVchkLP        EQU      *              
02271    2271     00001 0                DS       %00001         ; check #00 (+0/+0)
02272    2272     40000 0                DS       %40000         ; check #01 (+0/-0)
02273    2273     40001 1                DS       %40001         ; check #02 (-0/+0)
02274    2274     00001 0                DS       %00001         ; check #03 (-0/-0)
                          
02275    2275     00001 0                DS       %00001         ; check #04 (+0/+1)
02276    2276     40000 0                DS       %40000         ; check #05 (+0/-1)
02277    2277     40001 1                DS       %40001         ; check #06 (-0/+1)
02300    2300     00001 0                DS       %00001         ; check #07 (-0/-1)
                          
02301    2301     00001 0                DS       %00001         ; check #08 (+0/+16383)
02302    2302     40000 0                DS       %40000         ; check #09 (+0/-16383)
02303    2303     40001 1                DS       %40001         ; check #10 (-0/+16383)
02304    2304     00001 0                DS       %00001         ; check #11 (-0/-16383)
                          
02305    2305     00001 0                DS       %00001         ; check #12 (+16382/+16383)
02306    2306     40000 0                DS       %40000         ; check #13 (+16382/-16383)
02307    2307     40001 1                DS       %40001         ; check #14 (-16382/+16383)
02310    2310     00001 0                DS       %00001         ; check #15 (-16382/-16383)
                          
02311    2311     00001 0                DS       %00001         ; check #16 (+16383/+16383)
02312    2312     40000 0                DS       %40000         ; check #17 (+16383/-16383)
02313    2313     40001 1                DS       %40001         ; check #18 (-16383/+16383)
02314    2314     00001 0                DS       %00001         ; check #19 (-16383/-16383)
                          
02315    2315     00001 0                DS       %00001         ; check #20 (+1/+2)
02316    2316     00001 0                DS       %00001         ; check #21 (+1/+3)
02317    2317     00001 0                DS       %00001         ; check #22 (+1/+4)
02320    2320     00001 0                DS       %00001         ; check #23 (+1/+5)
02321    2321     00001 0                DS       %00001         ; check #24 (+1/+6)
02322    2322     00001 0                DS       %00001         ; check #25 (+1/+7)
02323    2323     00001 0                DS       %00001         ; check #26 (+1/+8)
                          
02324    2324     00001 0                DS       %00001         ; check #27 (+1/+6)
02325    2325     00001 0                DS       %00001         ; check #28 (+2/+12)
02326    2326     00001 0                DS       %00001         ; check #29 (+4/+24)
02327    2327     00001 0                DS       %00001         ; check #30 (+8/+48)
02330    2330     00001 0                DS       %00001         ; check #31 (+16/+96)
                          
                          ; ----------------------------------------------
                          ; Extender code
                          ; ----------------------------------------------
                                         ORG      EXTENDER       
05777    5777     47777 0                DS       %47777         ; needed for EXTEND
                          
                          ;------------------------------------------------------------------------- 
                          ; END OF PROGRAM
                          ;------------------------------------------------------------------------- 
                          
                          
                          

Assembly complete. Errors = 0

Symbol table:
START          000000   DVtst          000002   OVFCNTR        000034   
PASS           012345   curtest        000100   savQ           000101   
DVsavA         000102   DVindex        000103   DVXTND         000104   
GOPROG         002000   goMAIN         002000   fail           002004   
end            002006   STRTcode       002007   begin          002010   
PASScode       002013   finish         002014   DVcode         002017   
DVstart        002020   chkDV          002021   DVloop         002026   
div1           002071   div2           002131   DVchkA         002171   
DVchkQ         002231   DVchkLP        002271   EXTENDER       005777   
Q              000001   A              000000   LP             000003   
